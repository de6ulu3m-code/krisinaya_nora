<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ğ£ÑÑ‚Ğ½Ğ°Ñ Ğ½Ğ¾Ñ€Ğ°</title>
    <style>
        :root { --bg-color: #1a120b; --text-color: #f3e5ab; }
        body {
            background-color: var(--bg-color); color: var(--text-color);
            font-family: 'Segoe UI', serif; display: flex; flex-direction: column;
            justify-content: center; align-items: center; min-height: 100vh; margin: 0; transition: 0.5s;
        }
        .nav-menu { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .nav-btn {
            background: #4a3728; color: #f3e5ab; border: 1px solid #8b4513;
            padding: 8px 12px; border-radius: 10px; cursor: pointer;
        }
        .nora-container {
            background: radial-gradient(circle, #3d2b1f 0%, #1a120b 100%);
            padding: 30px; text-align: center; border-radius: 40px;
            border: 2px solid #4a3728; box-shadow: 0 0 50px rgba(0,0,0,0.5);
            max-width: 320px; width: 90%; position: relative;
        }
        .rat-name { font-weight: bold; color: #ffcc00; margin-bottom: 5px; font-size: 1.2rem; }
        .room-icon { font-size: 70px; margin: 10px 0; display: block; }
        .rat-resident { font-size: 45px; margin-top: -35px; margin-left: 50px; transition: 0.3s; }
        .btn-action {
            background: #8b4513; color: #fff; border: none;
            padding: 12px 20px; border-radius: 20px; cursor: pointer; margin-top: 15px; width: 100%;
        }
        .upgrade-item {
            background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px;
            margin-top: 10px; display: flex; justify-content: space-between; align-items: center;
        }
        #stock-display { color: #ffcc00; font-size: 1.2rem; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1 id="rat-name">Ğ”ÑĞ´ÑÑˆĞºĞ° ĞŸĞ¸ÑĞº</h1>
    
    <div style="font-size: 1.2rem; margin-bottom: 10px;">ğŸ§€ Ğ¡Ñ‹Ñ€: <span id="balance">0</span></div>

    <div id="room-display" style="background: #3d2b1f; padding: 30px; border-radius: 20px; border: 4px solid #5d4037; position: relative; min-height: 150px;">
        <div id="roomIcon" style="font-size: 60px; margin-bottom: 10px;">ğŸ”¥</div>
        <div id="ratIcon" style="font-size: 40px; position: absolute; bottom: 20px; left: 50px; transition: 0.3s;">ğŸ€</div>
    </div>

    <p id="roomDesc">Ğ“Ñ€ĞµĞµÑ‚ Ğ»Ğ°Ğ¿ĞºĞ¸ Ñƒ Ğ¾Ğ³Ğ½Ñ.</p>

    <button id="actionBtn" class="btn" onclick="handleAction()" style="width: 100%; margin-bottom: 10px;">ĞŸĞ¾ÑĞ»ÑƒÑˆĞ°Ñ‚ÑŒ ÑĞ¾Ğ²ĞµÑ‚</button>

    <div id="shop-items" style="display: none; background: #2d1f16; padding: 15px; border-radius: 10px; text-align: left;">
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>ğŸ›‹ï¸ Ğ”Ğ¸Ğ²Ğ°Ğ½ (10ğŸ§€)</span>
            <button class="btn" id="buy-sofa" onclick="buy('sofa', 10)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>ğŸ‘¨â€ğŸ³ ĞšĞ¾Ğ»Ğ¿Ğ°Ğº (20ğŸ§€)</span>
            <button class="btn" id="buy-hat" onclick="buy('hat', 20)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>â˜ï¸ ĞŸĞ¾Ğ´ÑƒÑˆĞºĞ° (30ğŸ§€)</span>
            <button class="btn" id="buy-pillow" onclick="buy('pillow', 30)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>ğŸ•¯ï¸ Ğ¡Ğ²ĞµÑ‡Ğ¸ (5ğŸ§€)</span>
            <button class="btn" id="buy-candles" onclick="buy('candles', 5)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>ğŸ§º Ğ“Ğ°Ğ¼Ğ°Ğº (15ğŸ§€)</span>
            <button class="btn" id="buy-hammock" onclick="buy('hammock', 15)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <span>ğŸ“» Ğ Ğ°Ğ´Ğ¸Ğ¾ (50ğŸ§€)</span>
            <button class="btn" id="buy-radio" onclick="buy('radio', 50)">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
        </div>
    </div>

    <hr style="border: 1px solid #5d4037; margin: 20px 0;">

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button class="btn" onclick="changeRoom('living')">ğŸ  Ğ“Ğ¾ÑÑ‚Ğ¸Ğ½Ğ°Ñ</button>
        <button class="btn" onclick="changeRoom('kitchen')">ğŸ³ ĞšÑƒÑ…Ğ½Ñ</button>
        <button class="btn" onclick="changeRoom('bedroom')">ğŸ’¤ Ğ¡Ğ¿Ğ°Ğ»ÑŒĞ½Ñ</button>
        <button class="btn" onclick="changeRoom('basement')">ğŸ“¦ ĞŸĞ¾Ğ´Ğ²Ğ°Ğ»</button>
        <button class="btn" onclick="changeRoom('shop')" style="grid-column: span 2; background: #5d4037;">ğŸ’° Ğ›Ğ°Ğ²ĞºĞ° Ğ¥Ğ¾Ğ¼ÑĞºĞ°</button>
        <button class="btn" onclick="window.location.href='/ratmetro/'" style="grid-column: span 2; background: #222; color: #ffcc00; border: 1px solid #ffcc00;">ğŸš‡ ĞœĞµÑ‚Ñ€Ğ¾</button>
    </div>
</div>

<audio id="fireSound" loop>
    <source src="fire.mp3" type="audio/mpeg">
</audio>
<audio id="eatSound"><source src="eat.mp3" type="audio/mpeg"></audio>

<script>
    let cheeseBalance = 0;
let currentRoom = 'living';
// Ğ˜Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€ÑŒ
let inventory = { 
    sofa: false, hat: false, pillow: false, 
    candles: false, hammock: false, radio: false 
};

const rooms = {
    living: { name: "Ğ”ÑĞ´ÑÑˆĞºĞ° ĞŸĞ¸ÑĞº", icon: "ğŸ”¥", rat: "ğŸ€", desc: "Ğ“Ñ€ĞµĞµÑ‚ Ğ»Ğ°Ğ¿ĞºĞ¸ Ñƒ Ğ¾Ğ³Ğ½Ñ.", btn: "ĞŸĞ¾ÑĞ»ÑƒÑˆĞ°Ñ‚ÑŒ ÑĞ¾Ğ²ĞµÑ‚" },
    kitchen: { name: "Ğ¨ĞµÑ„ Ğ ĞµĞ¼Ğ¸", icon: "ğŸ³", rat: "ğŸ€", desc: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¹ ÑÑ‹Ñ€ Ğ² Ğ¾ĞºÑ€ÑƒĞ³Ğµ!", btn: "Ğ’Ğ·ÑÑ‚ÑŒ ÑÑ‹Ñ€ ğŸ§€" },
    bedroom: { name: "ĞœĞ°Ğ»Ñ‹Ñˆ Ğ¡Ğ¾Ğ½Ñ", icon: "ğŸ’¤", rat: "ğŸ€", desc: "Ğ’Ğ¸Ğ´Ğ¸Ñ‚ ÑĞ½Ñ‹ Ğ¾ Ğ³Ğ¸Ğ³Ğ°Ğ½Ñ‚ÑĞºĞ¾Ğ¹ Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞµ ÑÑ‹Ñ€Ğ°.", btn: "ĞŸĞ¾Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ğ´ĞµÑĞ»Ğ¾" },
    basement: { name: "Ğ’Ğ¸Ğ½Ñ‚Ğ¸Ğº", icon: "ğŸ“¦", rat: "ğŸ€", desc: "ĞœĞ°ÑÑ‚ĞµÑ€Ğ¸Ñ‚ Ğ²ĞµÑ‡Ğ½Ñ‹Ğ¹ Ğ´Ğ²Ğ¸Ğ³Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ±ĞºĞ¸.", btn: "ĞŸĞ¾Ğ¼Ğ¾Ñ‡ÑŒ Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒÑ" },
    shop: { name: "Ğ¢Ğ¾Ñ€Ğ³Ğ¾Ğ²ĞµÑ† Ğ¥Ğ²Ğ¾ÑÑ‚", icon: "ğŸ’°", rat: "ğŸ¹", desc: "ĞœĞµĞ½ÑÑ ÑƒÑÑ‚ Ğ½Ğ° ÑÑ‹Ñ€!", btn: "ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹" }
};

// --- Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ Ğ¡ĞĞ¥Ğ ĞĞĞ•ĞĞ˜Ğ¯ ---
function saveGame() {
    localStorage.setItem('ratCheese', cheeseBalance);
    localStorage.setItem('ratInventory', JSON.stringify(inventory));
}

function loadGame() {
    const savedCheese = localStorage.getItem('ratCheese');
    const savedInv = localStorage.getItem('ratInventory');
    
    if (savedCheese !== null) {
        cheeseBalance = parseInt(savedCheese);
    }
    if (savedInv !== null) {
        inventory = JSON.parse(savedInv);
    }
    
    updateDisplay();
    changeRoom('living');
}

function updateDisplay() {
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ‡ĞµÑ‚Ñ‡Ğ¸Ğº ÑÑ‹Ñ€Ğ° Ğ²ĞµĞ·Ğ´Ğµ
    const balanceElements = document.querySelectorAll('#balance');
    balanceElements.forEach(el => el.innerText = cheeseBalance);
    
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ² Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğµ
    if (inventory.sofa && document.getElementById('buy-sofa')) document.getElementById('buy-sofa').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
    if (inventory.hat && document.getElementById('buy-hat')) document.getElementById('buy-hat').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
    if (inventory.pillow && document.getElementById('buy-pillow')) document.getElementById('buy-pillow').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
    if (inventory.candles && document.getElementById('buy-candles')) document.getElementById('buy-candles').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
    if (inventory.hammock && document.getElementById('buy-hammock')) document.getElementById('buy-hammock').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
    if (inventory.radio && document.getElementById('buy-radio')) document.getElementById('buy-radio').innerText = "ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾";
}

// --- Ğ›ĞĞ“Ğ˜ĞšĞ ĞšĞĞœĞĞĞ¢ ---
function changeRoom(id) {
    currentRoom = id;
    const r = rooms[id];
    const roomIcon = document.getElementById('roomIcon');
    const ratIcon = document.getElementById('ratIcon');
    const fire = document.getElementById('fireSound');
    
    document.getElementById('rat-name').innerText = r.name;
    document.getElementById('roomDesc').innerText = r.desc;
    roomIcon.style.filter = "none";

    // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¸ĞºĞ¾Ğ½ĞºÑƒ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ° (Ğ²ÑĞµ ĞºÑ€Ñ‹ÑÑ‹ ğŸ€, Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²ĞµÑ† Ñ…Ğ¾Ğ¼ÑĞº ğŸ¹)
    ratIcon.innerText = r.rat;

    if (id === 'living') {
        fire.play().catch(() => {});
        if (inventory.sofa) {
            roomIcon.innerHTML = "ğŸ”¥ <span style='margin-left:15px;'>ğŸ›‹ï¸</span>";
            ratIcon.style.marginLeft = "80px";
        } else {
            roomIcon.innerText = "ğŸ”¥";
            ratIcon.style.marginLeft = "50px";
        }
        if (inventory.candles) roomIcon.style.filter = "drop-shadow(0 0 15px #ffcc00)";
    } 
    else if (id === 'bedroom') {
        fire.pause();
        roomIcon.innerText = inventory.hammock ? "ğŸ§º" : r.icon;
        if (inventory.pillow) ratIcon.innerText = "â˜ï¸ğŸ€";
    }
    else if (id === 'kitchen') {
        fire.pause();
        roomIcon.innerText = r.icon;
        if (inventory.hat) ratIcon.innerText = "ğŸ‘¨â€ğŸ³ğŸ€";
    }
    else if (id === 'basement') {
        fire.pause();
        roomIcon.innerHTML = inventory.radio ? "ğŸ“¦ <span style='margin-left:10px;'>ğŸ“»</span>" : r.icon;
    }
    else {
        fire.pause();
        roomIcon.innerText = r.icon;
    }

    document.getElementById('actionBtn').innerText = r.btn;
    document.getElementById('shop-items').style.display = (id === 'shop') ? 'block' : 'none';
    document.getElementById('actionBtn').style.display = (id === 'shop') ? 'none' : 'block';
}

// --- ĞœĞĞ“ĞĞ—Ğ˜Ğ Ğ˜ Ğ”Ğ•Ğ™Ğ¡Ğ¢Ğ’Ğ˜Ğ¯ ---
function buy(item, price) {
    if (inventory[item]) return;
    if (cheeseBalance >= price) {
        cheeseBalance -= price;
        inventory[item] = true;
        saveGame();
        updateDisplay();
        changeRoom('shop'); 
    } else {
        alert("ĞœĞ°Ğ»Ğ¾Ğ²Ğ°Ñ‚Ğ¾ ÑÑ‹Ñ€Ğ°! ĞÑƒĞ¶Ğ½Ğ¾: " + price + " ğŸ§€");
    }
}

function handleAction() {
    if (currentRoom === 'kitchen') {
        cheeseBalance++; // ĞŸÑ€ÑĞ¼Ğ¾Ğµ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ
        saveGame();
        updateDisplay();
        alert("Ğ¨ĞµÑ„ Ğ ĞµĞ¼Ğ¸ Ğ´Ğ°Ğ» Ñ‚ĞµĞ±Ğµ ĞºÑƒÑĞ¾Ñ‡ĞµĞº ÑÑ‹Ñ€Ğ°! Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ñƒ Ñ‚ĞµĞ±Ñ: " + cheeseBalance + " ğŸ§€");
    } else if (currentRoom === 'living') {
        alert("Ğ”ÑĞ´ÑÑˆĞºĞ° ĞŸĞ¸ÑĞº: 'Ğ¡Ñ‹Ñ€ â€” ÑÑ‚Ğ¾ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾, Ğ° Ñ‚ĞµĞ¿Ğ»Ñ‹Ğ¹ ÑÑ‹Ñ€ â€” ĞµÑ‰Ğµ Ğ»ÑƒÑ‡ÑˆĞµ!'");
    } else if (currentRoom === 'basement') {
        alert("Ğ’Ğ¸Ğ½Ñ‚Ğ¸Ğº: 'ĞĞµ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ¸ Ğ½Ğ° ÑˆĞµÑÑ‚ĞµÑ€ĞµĞ½ĞºĞ¸!'");
    } else if (currentRoom === 'bedroom') {
        alert("Ğ¢ÑÑÑ... ĞœĞ°Ğ»Ñ‹Ñˆ Ğ¡Ğ¾Ğ½Ñ ÑĞ¿Ğ¸Ñ‚.");
    }
}

window.onload = loadGame;
</script>
</body>
</html>
